<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ† ERC-20 ç«èµ›éªŒè¯é¡µé¢</title>
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ’°</text></svg>">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #ff6b6b, #feca57);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .content {
            padding: 30px;
        }

        .status-bar {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            border-left: 5px solid #28a745;
        }

        .section {
            margin: 30px 0;
            padding: 25px;
            border: 2px solid #e9ecef;
            border-radius: 15px;
            transition: all 0.3s ease;
        }

        .section:hover {
            border-color: #007bff;
            box-shadow: 0 5px 15px rgba(0, 123, 255, 0.1);
        }

        .section h3 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .success {
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
            color: #155724;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            border-left: 5px solid #28a745;
        }

        .error {
            background: linear-gradient(135deg, #f8d7da, #f5c6cb);
            color: #721c24;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            border-left: 5px solid #dc3545;
        }

        .info {
            background: linear-gradient(135deg, #d1ecf1, #bee5eb);
            color: #0c5460;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            border-left: 5px solid #17a2b8;
        }

        .warning {
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
            color: #856404;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            border-left: 5px solid #ffc107;
        }

        button {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            margin: 8px;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 123, 255, 0.2);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 123, 255, 0.3);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        input {
            padding: 12px 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 16px;
            width: 100%;
            max-width: 400px;
            margin: 8px;
            transition: border-color 0.3s ease;
        }

        input:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
        }

        .input-group {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 10px;
            margin: 15px 0;
        }

        .code {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            border-left: 4px solid #007bff;
            word-break: break-all;
        }

        .logs {
            background: #1a1a1a;
            color: #00ff00;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 20px;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: #e9ecef;
            border-radius: 3px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #28a745, #20c997);
            width: 0%;
            transition: width 0.5s ease;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }

            .header {
                padding: 20px;
            }

            .header h1 {
                font-size: 2em;
            }

            .content {
                padding: 20px;
            }

            .input-group {
                flex-direction: column;
                align-items: stretch;
            }

            input {
                max-width: none;
                margin: 5px 0;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ† ERC-20 Token ç«èµ›éªŒè¯ç³»ç»Ÿ</h1>
            <p>Privacy Token (TPT) - ç¬¦åˆæ¯”èµ›è¦æ±‚çš„å®Œæ•´ERC-20å®ç°</p>
        </div>

        <div class="content">
            <div class="status-bar">
                <h3>ğŸ“Š ç³»ç»ŸçŠ¶æ€</h3>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressBar"></div>
                </div>
                <div id="systemStatus">åˆå§‹åŒ–ä¸­...</div>
            </div>

            <div class="grid">
                <div class="section">
                    <h3>ğŸ”— é’±åŒ…è¿æ¥</h3>
                    <button id="connectBtn" onclick="connectWallet()">è¿æ¥ MetaMask</button>
                    <div id="walletStatus"></div>
                    <div class="info" style="margin-top: 15px;">
                        <strong>ğŸ“ è¦æ±‚:</strong><br>
                        â€¢ éœ€è¦ MetaMask é’±åŒ…<br>
                        â€¢ åˆ‡æ¢åˆ°æœ¬åœ°ç½‘ç»œ (Chain ID: 31337)<br>
                        â€¢ ç¡®ä¿æœ¬åœ°èŠ‚ç‚¹è¿è¡Œä¸­
                    </div>
                </div>

                <div class="section">
                    <h3>ğŸ›ï¸ åˆçº¦ä¿¡æ¯</h3>
                    <button onclick="getContractInfo()">è·å–åˆçº¦è¯¦æƒ…</button>
                    <div id="contractInfo"></div>
                </div>
            </div>

            <div class="section">
                <h3>ğŸ’° ä½™é¢æŸ¥è¯¢</h3>
                <button onclick="checkBalance()">æŸ¥çœ‹ TPT ä½™é¢</button>
                <button onclick="checkETHBalance()">æŸ¥çœ‹ ETH ä½™é¢</button>
                <div id="balanceStatus"></div>
            </div>

            <div class="section">
                <h3>âœ… Approve æˆæƒåŠŸèƒ½ (æ¯”èµ›æ ¸å¿ƒè¦æ±‚)</h3>
                <div class="warning">
                    <strong>ğŸ¯ æ¯”èµ›éªŒè¯ç‚¹:</strong> è¿™æ˜¯æ¯”èµ›è¦æ±‚çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œå¿…é¡»é€šè¿‡ERC-20 approveæœºåˆ¶è¿›è¡Œä»£å¸æˆæƒ
                </div>
                <div class="input-group">
                    <input type="text" id="spenderAddress" placeholder="æˆæƒç»™çš„åœ°å€ (0x...)" />
                    <input type="number" id="approveAmount" placeholder="æˆæƒæ•°é‡" value="100" />
                    <button onclick="approveTokens()">ğŸ” æ‰§è¡Œ Approve æˆæƒ</button>
                </div>
                <div id="approveStatus"></div>
            </div>

            <div class="section">
                <h3>ğŸ” æˆæƒé¢åº¦æŸ¥è¯¢</h3>
                <div class="input-group">
                    <input type="text" id="checkSpenderAddress" placeholder="æŸ¥è¯¢æˆæƒç»™çš„åœ°å€ (0x...)" />
                    <button onclick="checkAllowance()">æŸ¥è¯¢ Allowance</button>
                </div>
                <div id="allowanceStatus"></div>
            </div>

            <div class="section">
                <h3>ğŸ’¸ è½¬è´¦æµ‹è¯•</h3>
                <div class="input-group">
                    <input type="text" id="transferTo" placeholder="æ¥æ”¶åœ°å€ (0x...)" />
                    <input type="number" id="transferAmount" placeholder="è½¬è´¦æ•°é‡" value="10" />
                    <button onclick="transferTokens()">å‘é€ TPT</button>
                </div>
                <div id="transferStatus"></div>
            </div>

            <div class="section">
                <h3>ğŸ§ª æ‰¹é‡æ“ä½œæµ‹è¯•</h3>
                <button onclick="runFullTest()">ğŸš€ è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶</button>
                <div id="testResults"></div>
            </div>

            <div class="section">
                <h3>ğŸ“œ æ“ä½œæ—¥å¿—</h3>
                <div id="logs" class="logs"></div>
            </div>
        </div>
    </div>

    <!-- ä½¿ç”¨å¯é çš„CDN -->
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
    <script>
        const CONTRACT_ADDRESS = "0x5FbDB2315678afecb367f032d93F642f64180aa3";
        const CHAIN_ID = 31337;

        // å®Œæ•´çš„ERC-20 ABI
        const ERC20_ABI = [
            "function name() view returns (string)",
            "function symbol() view returns (string)",
            "function decimals() view returns (uint8)",
            "function totalSupply() view returns (uint256)",
            "function balanceOf(address owner) view returns (uint256)",
            "function transfer(address to, uint256 amount) returns (bool)",
            "function approve(address spender, uint256 amount) returns (bool)",
            "function allowance(address owner, address spender) view returns (uint256)",
            "event Transfer(address indexed from, address indexed to, uint256 value)",
            "event Approval(address indexed owner, address indexed spender, uint256 value)"
        ];

        let provider, signer, contract, userAddress;
        let testsPassed = 0;
        let totalTests = 5;

        function updateProgress() {
            const percentage = (testsPassed / totalTests) * 100;
            document.getElementById('progressBar').style.width = percentage + '%';
        }

        function log(message, type = 'info') {
            console.log(message);
            const timestamp = new Date().toLocaleTimeString();
            const color = {
                'info': '#00ff00',
                'error': '#ff4444',
                'warning': '#ffaa00',
                'success': '#00ff88'
            }[type] || '#00ff00';

            const logsDiv = document.getElementById('logs');
            logsDiv.innerHTML += `<div style="color: ${color}">[${timestamp}] ${message}</div>`;
            logsDiv.scrollTop = logsDiv.scrollHeight;
        }

        async function initSystem() {
            try {
                document.getElementById('systemStatus').innerHTML = "ğŸ” æ£€æŸ¥ç¯å¢ƒ...";

                // æ£€æŸ¥ethers
                if (typeof ethers === 'undefined') {
                    throw new Error('Ethers.js åº“æœªåŠ è½½');
                }
                log('âœ… Ethers.js åº“åŠ è½½æˆåŠŸ', 'success');

                // æ£€æŸ¥MetaMask
                if (typeof window.ethereum === 'undefined') {
                    throw new Error('æœªæ£€æµ‹åˆ° MetaMask');
                }
                log('âœ… MetaMask æ£€æµ‹æˆåŠŸ', 'success');

                document.getElementById('systemStatus').innerHTML = "âœ… ç³»ç»Ÿå°±ç»ª - è¯·è¿æ¥é’±åŒ…å¼€å§‹æµ‹è¯•";
                testsPassed = 1;
                updateProgress();

            } catch (error) {
                document.getElementById('systemStatus').innerHTML = `âŒ ç³»ç»Ÿé”™è¯¯: ${error.message}`;
                log(`âŒ ç³»ç»Ÿåˆå§‹åŒ–å¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function connectWallet() {
            try {
                log('ğŸ”„ æ­£åœ¨è¿æ¥é’±åŒ…...', 'info');

                const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                if (accounts.length === 0) {
                    throw new Error('æœªæ‰¾åˆ°è´¦æˆ·');
                }

                provider = new ethers.providers.Web3Provider(window.ethereum);
                signer = provider.getSigner();
                userAddress = await signer.getAddress();

                // æ£€æŸ¥ç½‘ç»œ
                const network = await provider.getNetwork();
                if (network.chainId !== CHAIN_ID) {
                    throw new Error(`è¯·åˆ‡æ¢åˆ°æœ¬åœ°ç½‘ç»œ (Chain ID: ${CHAIN_ID}), å½“å‰: ${network.chainId}`);
                }

                contract = new ethers.Contract(CONTRACT_ADDRESS, ERC20_ABI, signer);

                document.getElementById('walletStatus').innerHTML =
                    `<div class="success">âœ… é’±åŒ…å·²è¿æ¥<br/>åœ°å€: ${userAddress}<br/>ç½‘ç»œ: Chain ID ${network.chainId}</div>`;

                log(`âœ… é’±åŒ…è¿æ¥æˆåŠŸ: ${userAddress}`, 'success');
                testsPassed = 2;
                updateProgress();

                // è‡ªåŠ¨è·å–åˆçº¦ä¿¡æ¯
                await getContractInfo();

            } catch (error) {
                document.getElementById('walletStatus').innerHTML =
                    `<div class="error">âŒ è¿æ¥å¤±è´¥: ${error.message}</div>`;
                log(`âŒ é’±åŒ…è¿æ¥å¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function getContractInfo() {
            try {
                if (!contract) throw new Error('è¯·å…ˆè¿æ¥é’±åŒ…');

                log('ğŸ”„ è·å–åˆçº¦ä¿¡æ¯...', 'info');

                const [name, symbol, decimals, totalSupply] = await Promise.all([
                    contract.name(),
                    contract.symbol(),
                    contract.decimals(),
                    contract.totalSupply()
                ]);

                const formattedSupply = ethers.utils.formatUnits(totalSupply, decimals);

                document.getElementById('contractInfo').innerHTML = `
                    <div class="success">
                        <strong>ğŸ“‹ åˆçº¦è¯¦æƒ…:</strong><br/>
                        <div class="code">
                            åç§°: ${name}<br/>
                            ç¬¦å·: ${symbol}<br/>
                            ç²¾åº¦: ${decimals}<br/>
                            æ€»ä¾›åº”é‡: ${formattedSupply}<br/>
                            åˆçº¦åœ°å€: ${CONTRACT_ADDRESS}
                        </div>
                    </div>
                `;

                log(`âœ… åˆçº¦ä¿¡æ¯è·å–æˆåŠŸ: ${name} (${symbol})`, 'success');
                testsPassed = 3;
                updateProgress();

            } catch (error) {
                document.getElementById('contractInfo').innerHTML =
                    `<div class="error">âŒ è·å–å¤±è´¥: ${error.message}</div>`;
                log(`âŒ åˆçº¦ä¿¡æ¯è·å–å¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function checkBalance() {
            try {
                if (!contract) throw new Error('è¯·å…ˆè¿æ¥é’±åŒ…');

                const balance = await contract.balanceOf(userAddress);
                const decimals = await contract.decimals();
                const formattedBalance = ethers.utils.formatUnits(balance, decimals);

                document.getElementById('balanceStatus').innerHTML =
                    `<div class="success">ğŸ’° TPT ä½™é¢: ${formattedBalance}</div>`;

                log(`ğŸ’° ä½™é¢æŸ¥è¯¢æˆåŠŸ: ${formattedBalance} TPT`, 'success');

            } catch (error) {
                document.getElementById('balanceStatus').innerHTML =
                    `<div class="error">âŒ æŸ¥è¯¢å¤±è´¥: ${error.message}</div>`;
                log(`âŒ ä½™é¢æŸ¥è¯¢å¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function checkETHBalance() {
            try {
                if (!provider) throw new Error('è¯·å…ˆè¿æ¥é’±åŒ…');

                const balance = await provider.getBalance(userAddress);
                const formattedBalance = ethers.utils.formatEther(balance);

                document.getElementById('balanceStatus').innerHTML +=
                    `<div class="info">âš¡ ETH ä½™é¢: ${formattedBalance}</div>`;

                log(`âš¡ ETHä½™é¢: ${formattedBalance} ETH`, 'info');

            } catch (error) {
                log(`âŒ ETHä½™é¢æŸ¥è¯¢å¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function approveTokens() {
            try {
                if (!contract) throw new Error('è¯·å…ˆè¿æ¥é’±åŒ…');

                const spender = document.getElementById('spenderAddress').value;
                const amount = document.getElementById('approveAmount').value;

                if (!spender || !amount) throw new Error('è¯·è¾“å…¥æˆæƒåœ°å€å’Œæ•°é‡');

                const decimals = await contract.decimals();
                const amountWei = ethers.utils.parseUnits(amount, decimals);

                log(`ğŸ”„ å¼€å§‹æ‰§è¡Œ Approve: ${amount} TPT æˆæƒç»™ ${spender}`, 'info');

                const tx = await contract.approve(spender, amountWei);

                document.getElementById('approveStatus').innerHTML =
                    `<div class="info">â³ Approve äº¤æ˜“æäº¤ä¸­...<br/>TxHash: ${tx.hash}</div>`;

                log(`ğŸ“¤ Approveäº¤æ˜“æäº¤: ${tx.hash}`, 'info');

                const receipt = await tx.wait();

                document.getElementById('approveStatus').innerHTML =
                    `<div class="success">ğŸ‰ Approve æˆæƒæˆåŠŸï¼<br/>Gasè´¹ç”¨: ${receipt.gasUsed.toString()}<br/>è¿™æ˜¯æ¯”èµ›è¦æ±‚çš„æ ¸å¿ƒåŠŸèƒ½ âœ…</div>`;

                log(`ğŸ‰ ApproveæˆæƒæˆåŠŸ! Gas: ${receipt.gasUsed}`, 'success');
                testsPassed = 4;
                updateProgress();

            } catch (error) {
                document.getElementById('approveStatus').innerHTML =
                    `<div class="error">âŒ Approveå¤±è´¥: ${error.message}</div>`;
                log(`âŒ Approveå¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function checkAllowance() {
            try {
                if (!contract) throw new Error('è¯·å…ˆè¿æ¥é’±åŒ…');

                const spender = document.getElementById('checkSpenderAddress').value;
                if (!spender) throw new Error('è¯·è¾“å…¥æŸ¥è¯¢åœ°å€');

                const allowance = await contract.allowance(userAddress, spender);
                const decimals = await contract.decimals();
                const formattedAllowance = ethers.utils.formatUnits(allowance, decimals);

                document.getElementById('allowanceStatus').innerHTML =
                    `<div class="success">ğŸ” å½“å‰æˆæƒé¢åº¦: ${formattedAllowance} TPT</div>`;

                log(`ğŸ” æˆæƒé¢åº¦æŸ¥è¯¢: ${formattedAllowance} TPT`, 'info');

            } catch (error) {
                document.getElementById('allowanceStatus').innerHTML =
                    `<div class="error">âŒ æŸ¥è¯¢å¤±è´¥: ${error.message}</div>`;
                log(`âŒ æˆæƒé¢åº¦æŸ¥è¯¢å¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function transferTokens() {
            try {
                if (!contract) throw new Error('è¯·å…ˆè¿æ¥é’±åŒ…');

                const to = document.getElementById('transferTo').value;
                const amount = document.getElementById('transferAmount').value;

                if (!to || !amount) throw new Error('è¯·è¾“å…¥æ¥æ”¶åœ°å€å’Œè½¬è´¦æ•°é‡');

                const decimals = await contract.decimals();
                const amountWei = ethers.utils.parseUnits(amount, decimals);

                log(`ğŸ”„ å¼€å§‹è½¬è´¦: ${amount} TPT åˆ° ${to}`, 'info');

                const tx = await contract.transfer(to, amountWei);

                document.getElementById('transferStatus').innerHTML =
                    `<div class="info">â³ è½¬è´¦æäº¤ä¸­...<br/>TxHash: ${tx.hash}</div>`;

                log(`ğŸ“¤ è½¬è´¦æäº¤: ${tx.hash}`, 'info');

                const receipt = await tx.wait();

                document.getElementById('transferStatus').innerHTML =
                    `<div class="success">âœ… è½¬è´¦æˆåŠŸï¼<br/>Gasè´¹ç”¨: ${receipt.gasUsed.toString()}</div>`;

                log(`âœ… è½¬è´¦æˆåŠŸ! Gas: ${receipt.gasUsed}`, 'success');
                testsPassed = 5;
                updateProgress();

            } catch (error) {
                document.getElementById('transferStatus').innerHTML =
                    `<div class="error">âŒ è½¬è´¦å¤±è´¥: ${error.message}</div>`;
                log(`âŒ è½¬è´¦å¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function runFullTest() {
            try {
                log('ğŸš€ å¼€å§‹è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶...', 'info');
                document.getElementById('testResults').innerHTML = '<div class="info">ğŸ”„ æ­£åœ¨è¿è¡Œæµ‹è¯•...</div>';

                const tests = [
                    { name: 'åˆçº¦ä¿¡æ¯è·å–', func: getContractInfo },
                    { name: 'ä½™é¢æŸ¥è¯¢', func: checkBalance },
                    { name: 'ETHä½™é¢æŸ¥è¯¢', func: checkETHBalance },
                ];

                for (const test of tests) {
                    log(`ğŸ§ª æµ‹è¯•: ${test.name}`, 'info');
                    await test.func();
                    await new Promise(resolve => setTimeout(resolve, 1000)); // ç­‰å¾…1ç§’
                }

                document.getElementById('testResults').innerHTML =
                    `<div class="success">ğŸ‰ æ‰€æœ‰æµ‹è¯•å®Œæˆï¼è¯·æ‰‹åŠ¨æµ‹è¯• Approve å’Œè½¬è´¦åŠŸèƒ½ä»¥æ»¡è¶³æ¯”èµ›è¦æ±‚ã€‚</div>`;

                log('ğŸ‰ å®Œæ•´æµ‹è¯•å¥—ä»¶æ‰§è¡Œå®Œæ¯•', 'success');

            } catch (error) {
                document.getElementById('testResults').innerHTML =
                    `<div class="error">âŒ æµ‹è¯•å¤±è´¥: ${error.message}</div>`;
                log(`âŒ æµ‹è¯•å¥—ä»¶å¤±è´¥: ${error.message}`, 'error');
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        window.onload = function () {
            log('ğŸŒŸ ERC-20 ç«èµ›éªŒè¯ç³»ç»Ÿå¯åŠ¨', 'success');

            // å¡«å……æµ‹è¯•åœ°å€
            document.getElementById('spenderAddress').value = "0x70997970C51812dc3A010C7d01b50e0d17dc79C8";
            document.getElementById('checkSpenderAddress').value = "0x70997970C51812dc3A010C7d01b50e0d17dc79C8";
            document.getElementById('transferTo').value = "0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC";

            // åˆå§‹åŒ–ç³»ç»Ÿ
            setTimeout(initSystem, 500);
        };

        // ç›‘å¬è´¦æˆ·å˜åŒ–
        if (typeof window.ethereum !== 'undefined') {
            window.ethereum.on('accountsChanged', function (accounts) {
                if (accounts.length === 0) {
                    log('ğŸ”Œ é’±åŒ…å·²æ–­å¼€è¿æ¥', 'warning');
                    location.reload();
                } else {
                    log('ğŸ”„ è´¦æˆ·å·²åˆ‡æ¢ï¼Œæ­£åœ¨é‡æ–°è¿æ¥...', 'info');
                    connectWallet();
                }
            });

            window.ethereum.on('chainChanged', function (chainId) {
                log(`ğŸ”„ ç½‘ç»œå·²åˆ‡æ¢åˆ°: ${chainId}`, 'info');
                location.reload();
            });
        }
    </script>
</body>

</html>